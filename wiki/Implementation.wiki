#summary How to use jSCEP in your own application
#labels Phase-Implementation,Featured

= Introduction =

This page discusses how to use jSCEP in your own application.  For full usage information, you are recommended to download and read the [http://code.google.com/p/jscep/downloads/list?q=label:Featured%20type=Docs current javadoc package].

= Details =

== Simple ==

{{{
X500Principal subject = new X500Principal("CN=jscep.googlecode.com,O=Google Inc,L=Mountain View,ST=California,C=US");
URL url = new URL("http://www.example.org/scep/");
Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress("proxy.example.org", 80));

Requester client = new Requester.Builder(url)
                                .proxy(proxy)
                                .subject(subject)
                                .build();
EnrollmentResult result = client.enroll("password".toCharArray()); 
// Retrieve the signed certificate
if (result.isPending() == false) {
    List<X509Certificate> certs = result.getCertificates();
    KeyPair pair = client.getKeyPair();     // Retrieve the generated key pair
}
}}}

== Renewing an Existing Certificate ==

If the CA supports renewal, we can renew an existing certificate.

{{{
X509Certificate identity = ...;
KeyPair keyPair = ...;
URL url = new URL("http://www.example.org/scep/");

Requester client = new Requester.Builder(url)
                                .identity(identity)
                                .keyPair(keyPair)
                                .build();
// Retrieve the renewed certificate
EnrollmentResult result = client.enroll("password".toCharArray()); 
if (result.isPending() == false) {
    List<X509Certificate> certs = result.getCertificates();
    identity = certs.get(0);
}
}}}

== Pending Response ==

{{{
X509Certificate identity = ...;
KeyPair keyPair = ...;
URL url = new URL("http://www.example.org/scep/");

Requester client = new Requester.Builder(url)
                                .identity(identity)
                                .keyPair(keyPair)
                                .build();
EnrollmentResult result = client.enroll("password".toCharArray());
ScheduledExecutorService exec = new ScheduledThreadPoolExecutor(1);
if (response.isPending()) {
    // We don't have a certificate yet, come back in two hours.
    Future<EnrollmentResponse> future = exec.schedule(result.getTask(), 2L, TimeUnit.HOURS);
}
}}}